{"ast":null,"code":"var _jsxFileName = \"/Users/vancetan/Documents/the-next-stage/Frontend/pages/gallery/index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { useQuery, usePaginatedQuery, queryCache } from \"react-query\";\nimport { range, useURLQuery } from \"../../utils\";\nimport { fetchTotal, fetchArtefacts } from \"../../utils/fetch\";\nimport SectionTitleBar from \"../../components/SectionTitleBar\";\nimport GalleryItem from \"../../components/GalleryItem\";\nimport Shim from \"../../components/Shim\";\nimport Pagination from \"../../components/Pagination\";\nimport GalleryModal from \"../../components/GalleryModal\";\nconst Gallery = styled.section.withConfig({\n  displayName: \"gallery__Gallery\",\n  componentId: \"sc-1flh0a9-0\"\n})([\"position:relative;display:flex;\"]);\nconst GalleryTitleBar = styled(SectionTitleBar).withConfig({\n  displayName: \"gallery__GalleryTitleBar\",\n  componentId: \"sc-1flh0a9-1\"\n})([\"padding-top:140px;\"]);\nconst GalleryContent = styled.div.withConfig({\n  displayName: \"gallery__GalleryContent\",\n  componentId: \"sc-1flh0a9-2\"\n})([\"padding:150px 100px 50px 100px;width:100%;@media (max-width:1200px){padding:150px 75px 50px 75px;}@media (max-width:896px){padding:150px 50px 50px 50px;}@media (max-width:600px){padding:150px 20px 50px 20px;}\"]);\nconst GalleryGrid = styled.ul.withConfig({\n  displayName: \"gallery__GalleryGrid\",\n  componentId: \"sc-1flh0a9-3\"\n})([\"--auto-grid-min-size:300px;display:grid;grid-template-columns:repeat( auto-fill,minmax(var(--auto-grid-min-size),1fr) );gap:30px;margin-top:50px;@media (max-width:896px){--auto-grid-min-size:200px;}\"]);\nconst GalleryItemShim = styled(Shim).withConfig({\n  displayName: \"gallery__GalleryItemShim\",\n  componentId: \"sc-1flh0a9-4\"\n})([\"border-radius:8px;height:300px;box-shadow:0 25px 50px -12px rgba(0,0,0,0.25);\"]);\nconst Count = styled.p.withConfig({\n  displayName: \"gallery__Count\",\n  componentId: \"sc-1flh0a9-5\"\n})([\"font-family:var(--font-primary);font-size:24px;color:var(--color-text);padding-left:12px;@media (max-width:1200px){font-size:22px;}@media (max-width:896px){font-size:20px;}@media (max-width:600px){font-size:18px;}\"]); // export async function getStaticProps() {\n//   const fetchedTotal = await fetch(\n//     \"https://the-next-stage.herokuapp.com/api/artefacts/count\"\n//   ).then((res) => res.json());\n//   const fetchedArtefacts = await fetch(\n//     `https://the-next-stage.herokuapp.com/api/artefact?page=1`\n//   ).then((res) => res.json());\n//   return {\n//     props: {\n//       total: fetchedTotal.data,\n//       artefacts: fetchedArtefacts.data,\n//     },\n//   };\n// }\n\nconst GalleryPage = () =>\n/*{ total, artefacts }*/\n{\n  const pageQuery = parseInt(useURLQuery().get(\"page\"), 10);\n  const {\n    0: page,\n    1: setPage\n  } = useState(pageQuery ? pageQuery : 1);\n  const {\n    0: content,\n    1: setContent\n  } = useState(null);\n  const {\n    0: contentIdx,\n    1: setContentIdx\n  } = useState(1);\n  const {\n    status: totalStatus,\n    data: total\n  } = useQuery(\"total\", fetchTotal, {\n    initialData: 0,\n    initialStale: true\n  });\n  const {\n    status: artefactsStatus,\n    resolvedData: artefacts\n  } = usePaginatedQuery([\"artefacts\", page], () => fetchArtefacts(page));\n  useEffect(() => {\n    if (page + 1 <= Math.ceil(total / 6)) {\n      queryCache.prefetchQuery([\"artefacts\", page + 1], () => fetchArtefacts(page + 1));\n    }\n  }, [page, total]);\n\n  const closeModal = () => {\n    setContent(null);\n    history.pushState({}, \"\", `/gallery?page=${page}`);\n  };\n\n  const goToNextItem = idx => {\n    if (idx + 1 <= artefacts.length - 1) {\n      setContentIdx(idx + 1);\n      setContent(artefacts[idx + 1]);\n      history.pushState({}, \"\", `/gallery/${artefacts[idx + 1].id}`);\n    }\n  };\n\n  const goToPreviousItem = idx => {\n    if (idx - 1 >= 0) {\n      setContentIdx(idx - 1);\n      setContent(artefacts[idx - 1]);\n      history.pushState({}, \"\", `/gallery/${artefacts[idx - 1].id}`);\n    }\n  };\n\n  return __jsx(Gallery, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 5\n    }\n  }, __jsx(GalleryTitleBar, {\n    position: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 7\n    }\n  }, \"gallery\"), __jsx(GalleryContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }\n  }, __jsx(Count, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 9\n    }\n  }, total, \" artefacts:\"), __jsx(Pagination, {\n    style: {\n      marginTop: 20\n    },\n    totalPages: Math.ceil(total / 6),\n    page: page,\n    setPage: setPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  }), __jsx(GalleryGrid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 9\n    }\n  }, artefacts ? artefacts.map((artefact, idx) => __jsx(GalleryItem, {\n    nickname: artefact.nickname,\n    form: artefact.form,\n    colorPoles: artefact.colorPoles,\n    key: idx,\n    onClick: () => {\n      setContentIdx(idx);\n      setContent(artefact);\n      history.pushState({}, \"\", `/gallery/${artefact.id}`);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  })) : range(6).map(idx => __jsx(GalleryItemShim, {\n    key: idx,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 37\n    }\n  })))), content ? __jsx(GalleryModal, {\n    content: content,\n    closeHandler: closeModal,\n    nextHandler: goToNextItem,\n    prevHandler: goToPreviousItem,\n    idx: contentIdx,\n    contents: artefacts,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 9\n    }\n  }) : null);\n};\n\nexport default GalleryPage;","map":{"version":3,"sources":["/Users/vancetan/Documents/the-next-stage/Frontend/pages/gallery/index.js"],"names":["useEffect","useState","styled","useQuery","usePaginatedQuery","queryCache","range","useURLQuery","fetchTotal","fetchArtefacts","SectionTitleBar","GalleryItem","Shim","Pagination","GalleryModal","Gallery","section","GalleryTitleBar","GalleryContent","div","GalleryGrid","ul","GalleryItemShim","Count","p","GalleryPage","pageQuery","parseInt","get","page","setPage","content","setContent","contentIdx","setContentIdx","status","totalStatus","data","total","initialData","initialStale","artefactsStatus","resolvedData","artefacts","Math","ceil","prefetchQuery","closeModal","history","pushState","goToNextItem","idx","length","id","goToPreviousItem","marginTop","map","artefact","nickname","form","colorPoles"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { useQuery, usePaginatedQuery, queryCache } from \"react-query\";\n\nimport { range, useURLQuery } from \"../../utils\";\nimport { fetchTotal, fetchArtefacts } from \"../../utils/fetch\";\n\nimport SectionTitleBar from \"../../components/SectionTitleBar\";\nimport GalleryItem from \"../../components/GalleryItem\";\nimport Shim from \"../../components/Shim\";\nimport Pagination from \"../../components/Pagination\";\nimport GalleryModal from \"../../components/GalleryModal\";\n\nconst Gallery = styled.section`\n  position: relative;\n  display: flex;\n`;\n\nconst GalleryTitleBar = styled(SectionTitleBar)`\n  padding-top: 140px;\n`;\n\nconst GalleryContent = styled.div`\n  padding: 150px 100px 50px 100px;\n  width: 100%;\n\n  @media (max-width: 1200px) {\n    padding: 150px 75px 50px 75px;\n  }\n\n  @media (max-width: 896px) {\n    padding: 150px 50px 50px 50px;\n  }\n\n  @media (max-width: 600px) {\n    padding: 150px 20px 50px 20px;\n  }\n`;\n\nconst GalleryGrid = styled.ul`\n  --auto-grid-min-size: 300px;\n\n  display: grid;\n  grid-template-columns: repeat(\n    auto-fill,\n    minmax(var(--auto-grid-min-size), 1fr)\n  );\n  gap: 30px;\n  margin-top: 50px;\n\n  @media (max-width: 896px) {\n    --auto-grid-min-size: 200px;\n  }\n`;\n\nconst GalleryItemShim = styled(Shim)`\n  border-radius: 8px;\n  height: 300px;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\n`;\n\nconst Count = styled.p`\n  font-family: var(--font-primary);\n  font-size: 24px;\n  color: var(--color-text);\n  padding-left: 12px;\n\n  @media (max-width: 1200px) {\n    font-size: 22px;\n  }\n\n  @media (max-width: 896px) {\n    font-size: 20px;\n  }\n\n  @media (max-width: 600px) {\n    font-size: 18px;\n  }\n`;\n\n// export async function getStaticProps() {\n//   const fetchedTotal = await fetch(\n//     \"https://the-next-stage.herokuapp.com/api/artefacts/count\"\n//   ).then((res) => res.json());\n//   const fetchedArtefacts = await fetch(\n//     `https://the-next-stage.herokuapp.com/api/artefact?page=1`\n//   ).then((res) => res.json());\n\n//   return {\n//     props: {\n//       total: fetchedTotal.data,\n//       artefacts: fetchedArtefacts.data,\n//     },\n//   };\n// }\n\nconst GalleryPage = (/*{ total, artefacts }*/) => {\n  const pageQuery = parseInt(useURLQuery().get(\"page\"), 10);\n\n  const [page, setPage] = useState(pageQuery ? pageQuery : 1);\n  const [content, setContent] = useState(null);\n  const [contentIdx, setContentIdx] = useState(1);\n\n  const { status: totalStatus, data: total } = useQuery(\"total\", fetchTotal, {\n    initialData: 0,\n    initialStale: true,\n  });\n\n  const {\n    status: artefactsStatus,\n    resolvedData: artefacts,\n  } = usePaginatedQuery([\"artefacts\", page], () => fetchArtefacts(page));\n\n  useEffect(() => {\n    if (page + 1 <= Math.ceil(total / 6)) {\n      queryCache.prefetchQuery([\"artefacts\", page + 1], () =>\n        fetchArtefacts(page + 1)\n      );\n    }\n  }, [page, total]);\n\n  const closeModal = () => {\n    setContent(null);\n    history.pushState({}, \"\", `/gallery?page=${page}`);\n  };\n  const goToNextItem = (idx) => {\n    if (idx + 1 <= artefacts.length - 1) {\n      setContentIdx(idx + 1);\n      setContent(artefacts[idx + 1]);\n      history.pushState({}, \"\", `/gallery/${artefacts[idx + 1].id}`);\n    }\n  };\n  const goToPreviousItem = (idx) => {\n    if (idx - 1 >= 0) {\n      setContentIdx(idx - 1);\n      setContent(artefacts[idx - 1]);\n      history.pushState({}, \"\", `/gallery/${artefacts[idx - 1].id}`);\n    }\n  };\n\n  return (\n    <Gallery>\n      <GalleryTitleBar position=\"left\">gallery</GalleryTitleBar>\n      <GalleryContent>\n        <Count>{total} artefacts:</Count>\n        <Pagination\n          style={{ marginTop: 20 }}\n          totalPages={Math.ceil(total / 6)}\n          page={page}\n          setPage={setPage}\n        />\n        <GalleryGrid>\n          {artefacts\n            ? artefacts.map((artefact, idx) => (\n                <GalleryItem\n                  nickname={artefact.nickname}\n                  form={artefact.form}\n                  colorPoles={artefact.colorPoles}\n                  key={idx}\n                  onClick={() => {\n                    setContentIdx(idx);\n                    setContent(artefact);\n                    history.pushState({}, \"\", `/gallery/${artefact.id}`);\n                  }}\n                />\n              ))\n            : range(6).map((idx) => <GalleryItemShim key={idx} />)}\n        </GalleryGrid>\n      </GalleryContent>\n      {content ? (\n        <GalleryModal\n          content={content}\n          closeHandler={closeModal}\n          nextHandler={goToNextItem}\n          prevHandler={goToPreviousItem}\n          idx={contentIdx}\n          contents={artefacts}\n        />\n      ) : null}\n    </Gallery>\n  );\n};\n\nexport default GalleryPage;\n"]},"metadata":{},"sourceType":"module"}